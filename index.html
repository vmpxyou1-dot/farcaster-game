<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Block Dude â€“ Pay & Play</title>
<style>
  :root { --bg:#0b0f12; --card:#0f151a; --muted:#9aa7b1; --accent1:#6ef3c3; --accent2:#3dd7ff; }
  body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto; background:var(--bg); color:#e7ecf0; display:grid; place-items:center; min-height:100vh; }
  .overlay { position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.8); z-index:10; }
  .overlay-card { padding:24px; background:var(--card); border-radius:16px; text-align:center; }
  .btn-play { padding:12px 24px; font-weight:700; border-radius:12px; border:none; cursor:pointer; background:linear-gradient(90deg,var(--accent1),var(--accent2)); color:#02110d; font-size:18px; }
  canvas { display:block; margin:12px auto; background:#0e1418; border-radius:12px; }
</style>
</head>
<body>

<div id="intro-overlay" class="overlay">
  <div class="overlay-card">
    <h1>Welcome to Block Dude</h1>
    <p class="muted">Pay a small Base fee to unlock the level.</p>
    <button id="play" class="btn-play">Pay & Play</button>
  </div>
</div>

<canvas id="game" width="384" height="256"></canvas>

<script type="module">
  // Uncomment for Farcaster SDK payment
  /*
  import { sdk } from 'https://esm.sh/@farcaster/miniapp-sdk'
  sdk.actions.ready();
  */

  const overlay = document.getElementById('intro-overlay');
  const playBtn = document.getElementById('play');
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  // Simple Block Dude game variables
  const player = { x: 180, y: 200, w: 32, h: 32, color:'#6ef3c3' };
  const keys = { left:false, right:false, down:false };

  // Map / floor
  const floor = canvas.height - 32;

  function draw() {
    ctx.fillStyle = '#0e1418';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Player
    ctx.fillStyle = player.color;
    ctx.fillRect(player.x, player.y, player.w, player.h);

    // Floor
    ctx.fillStyle = '#3dd7ff';
    ctx.fillRect(0, floor, canvas.width, 32);
  }

  function update() {
    // Basic movement
    if(keys.left) player.x -= 2;
    if(keys.right) player.x += 2;
    if(keys.down) player.y += 2;

    // Gravity
    if(player.y + player.h < floor) player.y += 2;
    else player.y = floor - player.h;

    // Keep inside canvas
    if(player.x < 0) player.x = 0;
    if(player.x + player.w > canvas.width) player.x = canvas.width - player.w;
  }

  function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
  }

  // Keyboard controls
  window.addEventListener('keydown', e => {
    if(e.key === 'ArrowLeft') keys.left = true;
    if(e.key === 'ArrowRight') keys.right = true;
    if(e.key === 'ArrowDown') keys.down = true;
  });
  window.addEventListener('keyup', e => {
    if(e.key === 'ArrowLeft') keys.left = false;
    if(e.key === 'ArrowRight') keys.right = false;
    if(e.key === 'ArrowDown') keys.down = false;
  });

  playBtn.addEventListener('click', async () => {
    // Uncomment for payment
    /*
    try {
      await requiredPayment(); // Implement your payment function here
    } catch(err) {
      alert('Payment failed or cancelled');
      return;
    }
    */
    overlay.style.display = 'none';
    loop();
  });
</script>
</body>
</html>

